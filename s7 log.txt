[2026-02-16 18:05:09,684] [PID 10] [MainThread] [dramatiq.MainProcess] [INFO] Dramatiq '2.0.1' is booting up.
2026-02-16 18:05:09.671 | INFO     | storage_uploader.worker:<module>:20 - Initializing s7-storage-uploader worker (broker=rabbitmq:5672/, current_queue=s7-storage-uploader, downstream_queue=s8-nocodb-updater, chevereto_base_url=https://imagor.wanyouwan.cn)
2026-02-16 18:05:09.682 | INFO     | storage_uploader.worker:<module>:161 - Worker started with actors: ['s7_storage_uploader.ping', 's7_storage_uploader.process']
[2026-02-16 18:05:09,683] [PID 11] [MainThread] [dramatiq.WorkerProcess(0)] [INFO] Worker process is ready for action.
2026-02-16 18:21:57.736 | INFO     | storage_uploader.worker:process:106 - Received upload job for record_id=682
2026-02-16 18:22:01.223 | INFO     | storage_uploader.worker:process:142 - Upload complete for record_id=682, public_url=https://imagor.wanyouwan.cn/images/2026/02/16/record_682_2f02f4a314cc45bda520efb4c00905e8_composited.mp4, expiration_date_gmt=2026-02-19 18:22:01
2026-02-16 18:23:26.756 | INFO     | storage_uploader.worker:process:106 - Received upload job for record_id=682
2026-02-16 18:23:30.577 | INFO     | storage_uploader.worker:process:142 - Upload complete for record_id=682, public_url=https://imagor.wanyouwan.cn/images/2026/02/16/record_682_a0cd5e0a329b4f6b98901c4fa603227b_composited.mp4, expiration_date_gmt=2026-02-19 18:23:30
2026-02-16 18:26:25.544 | INFO     | storage_uploader.worker:process:106 - Received upload job for record_id=683
2026-02-16 18:26:28.604 | INFO     | storage_uploader.worker:process:142 - Upload complete for record_id=683, public_url=https://imagor.wanyouwan.cn/images/2026/02/16/record_683_874704573b6148a3a357f73eacb025cb_composited.mp4, expiration_date_gmt=2026-02-19 18:26:28
2026-02-18 00:00:39.234 | INFO     | storage_uploader.worker:process:106 - Received upload job for record_id=678
2026-02-18 00:00:42.592 | INFO     | storage_uploader.worker:process:142 - Upload complete for record_id=678, public_url=https://imagor.wanyouwan.cn/images/2026/02/17/record_678_ab6ffa801f60402ba80c3fa11fa134cc_composited.mp4, expiration_date_gmt=2026-02-21 00:00:42
2026-02-18 00:04:39.105 | INFO     | storage_uploader.worker:process:106 - Received upload job for record_id=679
2026-02-18 00:04:48.264 | ERROR    | storage_uploader.worker:process:155 - Failed upload for record_id=679
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/threading.py", line 1032, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x709d61a2b380>
    └ <WorkerThread(Thread-6, started daemon 123821181413056)>
  File "/usr/local/lib/python3.12/threading.py", line 1075, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x709d60e0f2e0>
    └ <WorkerThread(Thread-6, started daemon 123821181413056)>
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/worker.py", line 515, in run
    self.process_message(message)
    │    │               └ <_RabbitmqMessage Message(queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process', args=(679, 'murmwwnt5uk...
    │    └ <function WorkerThread.process_message at 0x709d60e0f380>
    └ <WorkerThread(Thread-6, started daemon 123821181413056)>
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/worker.py", line 540, in process_message
    res = actor(*message.args, **message.kwargs)
          │      │               └ <_RabbitmqMessage Message(queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process', args=(679, 'murmwwnt5uk...
          │      └ <_RabbitmqMessage Message(queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process', args=(679, 'murmwwnt5uk...
          └ Actor(<function process at 0x709d5f9e31a0>, queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process')
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/actor.py", line 194, in __call__
    return self.fn(*args, **kwargs)
           │    │   │       └ {}
           │    │   └ (679, 'murmwwnt5ukvp7i', '/data/s6/record_679_b7acb55bd8b440ae886e19d308f50b65_composited.mp4')
           │    └ <function process at 0x709d5f9e31a0>
           └ Actor(<function process at 0x709d5f9e31a0>, queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process')
> File "/app/src/storage_uploader/worker.py", line 124, in process
    upload_payload = _upload_to_chevereto(
                     └ <function _upload_to_chevereto at 0x709d5f9e2ca0>
  File "/app/src/storage_uploader/worker.py", line 88, in _upload_to_chevereto
    raise RuntimeError(
RuntimeError: Chevereto upload failed (status=400): {"status_code": 400, "error": {"message": "Empty upload source", "code": 130}, "status_txt": "Bad Request"}
[2026-02-18 00:04:48,277] [PID 11] [Thread-6] [dramatiq.worker.WorkerThread] [ERROR] Failed to process message s7_storage_uploader.process(679, 'murmwwnt5ukvp7i', '/data/s6/record_679_b7acb55bd8b440ae886e19d308f50b65_composited.mp4') with unhandled exception.
Traceback (most recent call last):
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/worker.py", line 540, in process_message
    res = actor(*message.args, **message.kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/actor.py", line 194, in __call__
    return self.fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/src/storage_uploader/worker.py", line 124, in process
    upload_payload = _upload_to_chevereto(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/app/src/storage_uploader/worker.py", line 88, in _upload_to_chevereto
    raise RuntimeError(
RuntimeError: Chevereto upload failed (status=400): {"status_code": 400, "error": {"message": "Empty upload source", "code": 130}, "status_txt": "Bad Request"}
[2026-02-18 00:04:48,278] [PID 11] [Thread-6] [dramatiq.middleware.retries.Retries] [INFO] Retrying message '520e8c49-fe18-466d-b770-725dceff4e3f' in 18993 milliseconds.
2026-02-18 00:05:07.310 | INFO     | storage_uploader.worker:process:106 - Received upload job for record_id=679
2026-02-18 00:05:15.660 | ERROR    | storage_uploader.worker:process:155 - Failed upload for record_id=679
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/threading.py", line 1032, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x709d61a2b380>
    └ <WorkerThread(Thread-5, started daemon 123821189822144)>
  File "/usr/local/lib/python3.12/threading.py", line 1075, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x709d60e0f2e0>
    └ <WorkerThread(Thread-5, started daemon 123821189822144)>
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/worker.py", line 515, in run
    self.process_message(message)
    │    │               └ <_RabbitmqMessage Message(queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process', args=(679, 'murmwwnt5uk...
    │    └ <function WorkerThread.process_message at 0x709d60e0f380>
    └ <WorkerThread(Thread-5, started daemon 123821189822144)>
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/worker.py", line 540, in process_message
    res = actor(*message.args, **message.kwargs)
          │      │               └ <_RabbitmqMessage Message(queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process', args=(679, 'murmwwnt5uk...
          │      └ <_RabbitmqMessage Message(queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process', args=(679, 'murmwwnt5uk...
          └ Actor(<function process at 0x709d5f9e31a0>, queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process')
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/actor.py", line 194, in __call__
    return self.fn(*args, **kwargs)
           │    │   │       └ {}
           │    │   └ (679, 'murmwwnt5ukvp7i', '/data/s6/record_679_b7acb55bd8b440ae886e19d308f50b65_composited.mp4')
           │    └ <function process at 0x709d5f9e31a0>
           └ Actor(<function process at 0x709d5f9e31a0>, queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process')
> File "/app/src/storage_uploader/worker.py", line 124, in process
    upload_payload = _upload_to_chevereto(
                     └ <function _upload_to_chevereto at 0x709d5f9e2ca0>
  File "/app/src/storage_uploader/worker.py", line 88, in _upload_to_chevereto
    raise RuntimeError(
RuntimeError: Chevereto upload failed (status=400): {"status_code": 400, "error": {"message": "Empty upload source", "code": 130}, "status_txt": "Bad Request"}
[2026-02-18 00:05:15,674] [PID 11] [Thread-5] [dramatiq.worker.WorkerThread] [ERROR] Failed to process message s7_storage_uploader.process(679, 'murmwwnt5ukvp7i', '/data/s6/record_679_b7acb55bd8b440ae886e19d308f50b65_composited.mp4') with unhandled exception.
Traceback (most recent call last):
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/worker.py", line 540, in process_message
    res = actor(*message.args, **message.kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/actor.py", line 194, in __call__
    return self.fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/src/storage_uploader/worker.py", line 124, in process
    upload_payload = _upload_to_chevereto(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/app/src/storage_uploader/worker.py", line 88, in _upload_to_chevereto
    raise RuntimeError(
RuntimeError: Chevereto upload failed (status=400): {"status_code": 400, "error": {"message": "Empty upload source", "code": 130}, "status_txt": "Bad Request"}
[2026-02-18 00:05:15,675] [PID 11] [Thread-5] [dramatiq.middleware.retries.Retries] [INFO] Retrying message '520e8c49-fe18-466d-b770-725dceff4e3f' in 48952 milliseconds.
2026-02-18 00:06:04.737 | INFO     | storage_uploader.worker:process:106 - Received upload job for record_id=679
2026-02-18 00:06:13.773 | ERROR    | storage_uploader.worker:process:155 - Failed upload for record_id=679
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/threading.py", line 1032, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x709d61a2b380>
    └ <WorkerThread(Thread-7, started daemon 123821173003968)>
  File "/usr/local/lib/python3.12/threading.py", line 1075, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x709d60e0f2e0>
    └ <WorkerThread(Thread-7, started daemon 123821173003968)>
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/worker.py", line 515, in run
    self.process_message(message)
    │    │               └ <_RabbitmqMessage Message(queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process', args=(679, 'murmwwnt5uk...
    │    └ <function WorkerThread.process_message at 0x709d60e0f380>
    └ <WorkerThread(Thread-7, started daemon 123821173003968)>
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/worker.py", line 540, in process_message
    res = actor(*message.args, **message.kwargs)
          │      │               └ <_RabbitmqMessage Message(queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process', args=(679, 'murmwwnt5uk...
          │      └ <_RabbitmqMessage Message(queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process', args=(679, 'murmwwnt5uk...
          └ Actor(<function process at 0x709d5f9e31a0>, queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process')
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/actor.py", line 194, in __call__
    return self.fn(*args, **kwargs)
           │    │   │       └ {}
           │    │   └ (679, 'murmwwnt5ukvp7i', '/data/s6/record_679_b7acb55bd8b440ae886e19d308f50b65_composited.mp4')
           │    └ <function process at 0x709d5f9e31a0>
           └ Actor(<function process at 0x709d5f9e31a0>, queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process')
> File "/app/src/storage_uploader/worker.py", line 124, in process
    upload_payload = _upload_to_chevereto(
                     └ <function _upload_to_chevereto at 0x709d5f9e2ca0>
  File "/app/src/storage_uploader/worker.py", line 88, in _upload_to_chevereto
    raise RuntimeError(
RuntimeError: Chevereto upload failed (status=400): {"status_code": 400, "error": {"message": "Empty upload source", "code": 130}, "status_txt": "Bad Request"}
[2026-02-18 00:06:13,785] [PID 11] [Thread-7] [dramatiq.worker.WorkerThread] [ERROR] Failed to process message s7_storage_uploader.process(679, 'murmwwnt5ukvp7i', '/data/s6/record_679_b7acb55bd8b440ae886e19d308f50b65_composited.mp4') with unhandled exception.
Traceback (most recent call last):
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/worker.py", line 540, in process_message
    res = actor(*message.args, **message.kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/actor.py", line 194, in __call__
    return self.fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/src/storage_uploader/worker.py", line 124, in process
    upload_payload = _upload_to_chevereto(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/app/src/storage_uploader/worker.py", line 88, in _upload_to_chevereto
    raise RuntimeError(
RuntimeError: Chevereto upload failed (status=400): {"status_code": 400, "error": {"message": "Empty upload source", "code": 130}, "status_txt": "Bad Request"}
[2026-02-18 00:06:13,785] [PID 11] [Thread-7] [dramatiq.middleware.retries.Retries] [INFO] Retrying message '520e8c49-fe18-466d-b770-725dceff4e3f' in 83758 milliseconds.
2026-02-18 00:07:37.878 | INFO     | storage_uploader.worker:process:106 - Received upload job for record_id=679
2026-02-18 00:07:46.470 | ERROR    | storage_uploader.worker:process:155 - Failed upload for record_id=679
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/threading.py", line 1032, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x709d61a2b380>
    └ <WorkerThread(Thread-6, started daemon 123821181413056)>
  File "/usr/local/lib/python3.12/threading.py", line 1075, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x709d60e0f2e0>
    └ <WorkerThread(Thread-6, started daemon 123821181413056)>
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/worker.py", line 515, in run
    self.process_message(message)
    │    │               └ <_RabbitmqMessage Message(queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process', args=(679, 'murmwwnt5uk...
    │    └ <function WorkerThread.process_message at 0x709d60e0f380>
    └ <WorkerThread(Thread-6, started daemon 123821181413056)>
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/worker.py", line 540, in process_message
    res = actor(*message.args, **message.kwargs)
          │      │               └ <_RabbitmqMessage Message(queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process', args=(679, 'murmwwnt5uk...
          │      └ <_RabbitmqMessage Message(queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process', args=(679, 'murmwwnt5uk...
          └ Actor(<function process at 0x709d5f9e31a0>, queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process')
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/actor.py", line 194, in __call__
    return self.fn(*args, **kwargs)
           │    │   │       └ {}
           │    │   └ (679, 'murmwwnt5ukvp7i', '/data/s6/record_679_b7acb55bd8b440ae886e19d308f50b65_composited.mp4')
           │    └ <function process at 0x709d5f9e31a0>
           └ Actor(<function process at 0x709d5f9e31a0>, queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process')
> File "/app/src/storage_uploader/worker.py", line 124, in process
    upload_payload = _upload_to_chevereto(
                     └ <function _upload_to_chevereto at 0x709d5f9e2ca0>
  File "/app/src/storage_uploader/worker.py", line 88, in _upload_to_chevereto
    raise RuntimeError(
RuntimeError: Chevereto upload failed (status=400): {"status_code": 400, "error": {"message": "Empty upload source", "code": 130}, "status_txt": "Bad Request"}
[2026-02-18 00:07:46,481] [PID 11] [Thread-6] [dramatiq.worker.WorkerThread] [ERROR] Failed to process message s7_storage_uploader.process(679, 'murmwwnt5ukvp7i', '/data/s6/record_679_b7acb55bd8b440ae886e19d308f50b65_composited.mp4') with unhandled exception.
Traceback (most recent call last):
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/worker.py", line 540, in process_message
    res = actor(*message.args, **message.kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/actor.py", line 194, in __call__
    return self.fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/src/storage_uploader/worker.py", line 124, in process
    upload_payload = _upload_to_chevereto(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/app/src/storage_uploader/worker.py", line 88, in _upload_to_chevereto
    raise RuntimeError(
RuntimeError: Chevereto upload failed (status=400): {"status_code": 400, "error": {"message": "Empty upload source", "code": 130}, "status_txt": "Bad Request"}
[2026-02-18 00:07:46,481] [PID 11] [Thread-6] [dramatiq.middleware.retries.Retries] [INFO] Retrying message '520e8c49-fe18-466d-b770-725dceff4e3f' in 199577 milliseconds.
2026-02-18 00:11:06.694 | INFO     | storage_uploader.worker:process:106 - Received upload job for record_id=679
2026-02-18 00:11:15.174 | ERROR    | storage_uploader.worker:process:155 - Failed upload for record_id=679
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/threading.py", line 1032, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x709d61a2b380>
    └ <WorkerThread(Thread-5, started daemon 123821189822144)>
  File "/usr/local/lib/python3.12/threading.py", line 1075, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x709d60e0f2e0>
    └ <WorkerThread(Thread-5, started daemon 123821189822144)>
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/worker.py", line 515, in run
    self.process_message(message)
    │    │               └ <_RabbitmqMessage Message(queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process', args=(679, 'murmwwnt5uk...
    │    └ <function WorkerThread.process_message at 0x709d60e0f380>
    └ <WorkerThread(Thread-5, started daemon 123821189822144)>
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/worker.py", line 540, in process_message
    res = actor(*message.args, **message.kwargs)
          │      │               └ <_RabbitmqMessage Message(queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process', args=(679, 'murmwwnt5uk...
          │      └ <_RabbitmqMessage Message(queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process', args=(679, 'murmwwnt5uk...
          └ Actor(<function process at 0x709d5f9e31a0>, queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process')
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/actor.py", line 194, in __call__
    return self.fn(*args, **kwargs)
           │    │   │       └ {}
           │    │   └ (679, 'murmwwnt5ukvp7i', '/data/s6/record_679_b7acb55bd8b440ae886e19d308f50b65_composited.mp4')
           │    └ <function process at 0x709d5f9e31a0>
           └ Actor(<function process at 0x709d5f9e31a0>, queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process')
> File "/app/src/storage_uploader/worker.py", line 124, in process
    upload_payload = _upload_to_chevereto(
                     └ <function _upload_to_chevereto at 0x709d5f9e2ca0>
  File "/app/src/storage_uploader/worker.py", line 88, in _upload_to_chevereto
    raise RuntimeError(
RuntimeError: Chevereto upload failed (status=400): {"status_code": 400, "error": {"message": "Empty upload source", "code": 130}, "status_txt": "Bad Request"}
[2026-02-18 00:11:15,184] [PID 11] [Thread-5] [dramatiq.worker.WorkerThread] [ERROR] Failed to process message s7_storage_uploader.process(679, 'murmwwnt5ukvp7i', '/data/s6/record_679_b7acb55bd8b440ae886e19d308f50b65_composited.mp4') with unhandled exception.
Traceback (most recent call last):
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/worker.py", line 540, in process_message
    res = actor(*message.args, **message.kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/actor.py", line 194, in __call__
    return self.fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/src/storage_uploader/worker.py", line 124, in process
    upload_payload = _upload_to_chevereto(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/app/src/storage_uploader/worker.py", line 88, in _upload_to_chevereto
    raise RuntimeError(
RuntimeError: Chevereto upload failed (status=400): {"status_code": 400, "error": {"message": "Empty upload source", "code": 130}, "status_txt": "Bad Request"}
[2026-02-18 00:11:15,185] [PID 11] [Thread-5] [dramatiq.middleware.retries.Retries] [INFO] Retrying message '520e8c49-fe18-466d-b770-725dceff4e3f' in 422949 milliseconds.
2026-02-18 00:18:18.631 | INFO     | storage_uploader.worker:process:106 - Received upload job for record_id=679
2026-02-18 00:18:27.084 | ERROR    | storage_uploader.worker:process:155 - Failed upload for record_id=679
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/threading.py", line 1032, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x709d61a2b380>
    └ <WorkerThread(Thread-10, started daemon 123820677523136)>
  File "/usr/local/lib/python3.12/threading.py", line 1075, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x709d60e0f2e0>
    └ <WorkerThread(Thread-10, started daemon 123820677523136)>
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/worker.py", line 515, in run
    self.process_message(message)
    │    │               └ <_RabbitmqMessage Message(queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process', args=(679, 'murmwwnt5uk...
    │    └ <function WorkerThread.process_message at 0x709d60e0f380>
    └ <WorkerThread(Thread-10, started daemon 123820677523136)>
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/worker.py", line 540, in process_message
    res = actor(*message.args, **message.kwargs)
          │      │               └ <_RabbitmqMessage Message(queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process', args=(679, 'murmwwnt5uk...
          │      └ <_RabbitmqMessage Message(queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process', args=(679, 'murmwwnt5uk...
          └ Actor(<function process at 0x709d5f9e31a0>, queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process')
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/actor.py", line 194, in __call__
    return self.fn(*args, **kwargs)
           │    │   │       └ {}
           │    │   └ (679, 'murmwwnt5ukvp7i', '/data/s6/record_679_b7acb55bd8b440ae886e19d308f50b65_composited.mp4')
           │    └ <function process at 0x709d5f9e31a0>
           └ Actor(<function process at 0x709d5f9e31a0>, queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process')
> File "/app/src/storage_uploader/worker.py", line 124, in process
    upload_payload = _upload_to_chevereto(
                     └ <function _upload_to_chevereto at 0x709d5f9e2ca0>
  File "/app/src/storage_uploader/worker.py", line 88, in _upload_to_chevereto
    raise RuntimeError(
RuntimeError: Chevereto upload failed (status=400): {"status_code": 400, "error": {"message": "Empty upload source", "code": 130}, "status_txt": "Bad Request"}
[2026-02-18 00:18:27,096] [PID 11] [Thread-10] [dramatiq.worker.WorkerThread] [ERROR] Failed to process message s7_storage_uploader.process(679, 'murmwwnt5ukvp7i', '/data/s6/record_679_b7acb55bd8b440ae886e19d308f50b65_composited.mp4') with unhandled exception.
Traceback (most recent call last):
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/worker.py", line 540, in process_message
    res = actor(*message.args, **message.kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/actor.py", line 194, in __call__
    return self.fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/src/storage_uploader/worker.py", line 124, in process
    upload_payload = _upload_to_chevereto(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/app/src/storage_uploader/worker.py", line 88, in _upload_to_chevereto
    raise RuntimeError(
RuntimeError: Chevereto upload failed (status=400): {"status_code": 400, "error": {"message": "Empty upload source", "code": 130}, "status_txt": "Bad Request"}
[2026-02-18 00:18:27,096] [PID 11] [Thread-10] [dramatiq.middleware.retries.Retries] [INFO] Retrying message '520e8c49-fe18-466d-b770-725dceff4e3f' in 652973 milliseconds.
2026-02-18 00:29:20.799 | INFO     | storage_uploader.worker:process:106 - Received upload job for record_id=679
2026-02-18 00:29:29.882 | ERROR    | storage_uploader.worker:process:155 - Failed upload for record_id=679
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/threading.py", line 1032, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x709d61a2b380>
    └ <WorkerThread(Thread-7, started daemon 123821173003968)>
  File "/usr/local/lib/python3.12/threading.py", line 1075, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x709d60e0f2e0>
    └ <WorkerThread(Thread-7, started daemon 123821173003968)>
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/worker.py", line 515, in run
    self.process_message(message)
    │    │               └ <_RabbitmqMessage Message(queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process', args=(679, 'murmwwnt5uk...
    │    └ <function WorkerThread.process_message at 0x709d60e0f380>
    └ <WorkerThread(Thread-7, started daemon 123821173003968)>
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/worker.py", line 540, in process_message
    res = actor(*message.args, **message.kwargs)
          │      │               └ <_RabbitmqMessage Message(queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process', args=(679, 'murmwwnt5uk...
          │      └ <_RabbitmqMessage Message(queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process', args=(679, 'murmwwnt5uk...
          └ Actor(<function process at 0x709d5f9e31a0>, queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process')
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/actor.py", line 194, in __call__
    return self.fn(*args, **kwargs)
           │    │   │       └ {}
           │    │   └ (679, 'murmwwnt5ukvp7i', '/data/s6/record_679_b7acb55bd8b440ae886e19d308f50b65_composited.mp4')
           │    └ <function process at 0x709d5f9e31a0>
           └ Actor(<function process at 0x709d5f9e31a0>, queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process')
> File "/app/src/storage_uploader/worker.py", line 124, in process
    upload_payload = _upload_to_chevereto(
                     └ <function _upload_to_chevereto at 0x709d5f9e2ca0>
  File "/app/src/storage_uploader/worker.py", line 88, in _upload_to_chevereto
    raise RuntimeError(
RuntimeError: Chevereto upload failed (status=400): {"status_code": 400, "error": {"message": "Empty upload source", "code": 130}, "status_txt": "Bad Request"}
[2026-02-18 00:29:29,892] [PID 11] [Thread-7] [dramatiq.worker.WorkerThread] [ERROR] Failed to process message s7_storage_uploader.process(679, 'murmwwnt5ukvp7i', '/data/s6/record_679_b7acb55bd8b440ae886e19d308f50b65_composited.mp4') with unhandled exception.
Traceback (most recent call last):
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/worker.py", line 540, in process_message
    res = actor(*message.args, **message.kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/actor.py", line 194, in __call__
    return self.fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/src/storage_uploader/worker.py", line 124, in process
    upload_payload = _upload_to_chevereto(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/app/src/storage_uploader/worker.py", line 88, in _upload_to_chevereto
    raise RuntimeError(
RuntimeError: Chevereto upload failed (status=400): {"status_code": 400, "error": {"message": "Empty upload source", "code": 130}, "status_txt": "Bad Request"}
[2026-02-18 00:29:29,893] [PID 11] [Thread-7] [dramatiq.middleware.retries.Retries] [INFO] Retrying message '520e8c49-fe18-466d-b770-725dceff4e3f' in 1840311 milliseconds.
[2026-02-18 00:59:29,927] [PID 11] [Thread-4] [dramatiq.worker.ConsumerThread(s7-storage-uploader.DQ)] [CRITICAL] Consumer encountered a connection error: (406, 'PRECONDITION_FAILED - delivery acknowledgement on channel 1 timed out. Timeout value used: 1800000 ms. This timeout value can be configured, see consumers doc guide to learn more')
[2026-02-18 00:59:29,927] [PID 11] [Thread-4] [dramatiq.worker.ConsumerThread(s7-storage-uploader.DQ)] [INFO] Restarting consumer in 3.00 seconds.
2026-02-18 01:00:10.972 | INFO     | storage_uploader.worker:process:106 - Received upload job for record_id=679
2026-02-18 01:00:12.126 | INFO     | storage_uploader.worker:process:106 - Received upload job for record_id=683
2026-02-18 01:00:17.878 | INFO     | storage_uploader.worker:process:142 - Upload complete for record_id=683, public_url=https://imagor.wanyouwan.cn/images/2026/02/17/record_683_109f3d1f19934a26ae31b71f842f2c10_composited.mp4, expiration_date_gmt=2026-02-21 01:00:17
2026-02-18 01:00:20.562 | ERROR    | storage_uploader.worker:process:155 - Failed upload for record_id=679
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/threading.py", line 1032, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x709d61a2b380>
    └ <WorkerThread(Thread-7, started daemon 123821173003968)>
  File "/usr/local/lib/python3.12/threading.py", line 1075, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x709d60e0f2e0>
    └ <WorkerThread(Thread-7, started daemon 123821173003968)>
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/worker.py", line 515, in run
    self.process_message(message)
    │    │               └ <_RabbitmqMessage Message(queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process', args=(679, 'murmwwnt5uk...
    │    └ <function WorkerThread.process_message at 0x709d60e0f380>
    └ <WorkerThread(Thread-7, started daemon 123821173003968)>
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/worker.py", line 540, in process_message
    res = actor(*message.args, **message.kwargs)
          │      │               └ <_RabbitmqMessage Message(queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process', args=(679, 'murmwwnt5uk...
          │      └ <_RabbitmqMessage Message(queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process', args=(679, 'murmwwnt5uk...
          └ Actor(<function process at 0x709d5f9e31a0>, queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process')
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/actor.py", line 194, in __call__
    return self.fn(*args, **kwargs)
           │    │   │       └ {}
           │    │   └ (679, 'murmwwnt5ukvp7i', '/data/s6/record_679_b7acb55bd8b440ae886e19d308f50b65_composited.mp4')
           │    └ <function process at 0x709d5f9e31a0>
           └ Actor(<function process at 0x709d5f9e31a0>, queue_name='s7-storage-uploader', actor_name='s7_storage_uploader.process')
> File "/app/src/storage_uploader/worker.py", line 124, in process
    upload_payload = _upload_to_chevereto(
                     └ <function _upload_to_chevereto at 0x709d5f9e2ca0>
  File "/app/src/storage_uploader/worker.py", line 88, in _upload_to_chevereto
    raise RuntimeError(
RuntimeError: Chevereto upload failed (status=400): {"status_code": 400, "error": {"message": "Empty upload source", "code": 130}, "status_txt": "Bad Request"}
[2026-02-18 01:00:20,572] [PID 11] [Thread-7] [dramatiq.worker.WorkerThread] [ERROR] Failed to process message s7_storage_uploader.process(679, 'murmwwnt5ukvp7i', '/data/s6/record_679_b7acb55bd8b440ae886e19d308f50b65_composited.mp4') with unhandled exception.
Traceback (most recent call last):
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/worker.py", line 540, in process_message
    res = actor(*message.args, **message.kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/dramatiq/actor.py", line 194, in __call__
    return self.fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/src/storage_uploader/worker.py", line 124, in process
    upload_payload = _upload_to_chevereto(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/app/src/storage_uploader/worker.py", line 88, in _upload_to_chevereto
    raise RuntimeError(
RuntimeError: Chevereto upload failed (status=400): {"status_code": 400, "error": {"message": "Empty upload source", "code": 130}, "status_txt": "Bad Request"}
[2026-02-18 01:00:20,573] [PID 11] [Thread-7] [dramatiq.middleware.retries.Retries] [INFO] Retrying message '520e8c49-fe18-466d-b770-725dceff4e3f' in 3120269 milliseconds.